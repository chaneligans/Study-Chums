<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Study Chums</title>
    <link rel="stylesheet" href="main.css">

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css"><script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
    $(document).ready(function(){
      $('.navbar-toggle').click(function() {
        $('#nav').toggle('.unhide');
      });
    });
    </script>

  </head>
  <body>

    <div id="wrapper">

      <!-- NAVIGATION MENU -->
      <nav class="navbar">
        <span class="navbar-toggle" id="js-navbar-toggle">
          &#x2630;
        </span>

        <ul id="nav" class="main-nav">
          <li><a href="home.html" class="nav-item">Home</a></li>
          <li><a href="profile.html" class="nav-item">Profile</a></li>
          <li><a href="messages.html" class="nav-item">Messages</a></li>
          <li><a href="chums.html" class="nav-item">Chums</a></li>
          <li><a href="applications.html" class="nav-item">Applications</a></li>
          <li><a href="index.html" class="nav-item" onclick="facebookSignOut();">Sign Out</a></li>
        </ul>
      </nav>
      <!-- END OF NAVIGATION MENU -->

      <!-- CONTENT (description, profiles) -->
      <div id="description">
        <h1>Find your study buddy!</h1>
      </div>

      <div id="content">
        <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js">
          //set the configuration
          var config = {
            apiKey: 'AIzaSyDFPHvR2SV7dodysPpvLUfIGp6huuBDf0A',
            authDomain: 'study-chums.firebaseapp.com',
            databaseURL: 'https://study-chums.firebaseio.com',
            storageBucket: 'study-chums.appspot.com'
          };
          firebase.initializeApp(config);

          // Get a reference to the storage service, which is used to create references in your storage bucket
          var storage = firebase.storage();
          // Create a storage reference from our storage service
          var storageRef = storage.ref();
        </script>

      </div>
      <div id= "profileview">
        <script>
              document.getElementById("demo").innerHTML = 5 + 6;
        </script>
        <script>
            var database = firebase.database();
            function NextUser(id){
                var userDataRef = firebase.database().ref('users/User'+id);
                return userDataRef.once("value").then(function(snapshot){
                                               var userId = (snapshot.val() &&snapshot.val().id) || '0';
                                               });
            };
            function ProfilePhoto(){
                //count the number of users
                var usersRef = db.collection('users');
                var count = 0;
                var allUsers = usersRef.get().then(snapshot => {
                    snapshot.forEach(doc => {
                        console.log(doc.id '=>', doc.data());
                        count =(count || 0)+1;
                    });
                })
                .catch(err => {
                    console.log('Error getting documents', err);
                });
                //random pick a user number
                var randomid = Math.floor((Math.random * count)+1);
                document.getElementById("demo").innerHTML = 5;
            
                //try use gathering to collect the 
                var userId = NextUser(randomid);
            };
            document.getElementById("demo").innerHTML = 5;
            ProfilePhoto();
        </script>
        <div class="demo-card-square mdl-card mdl-shadow--2dp">
            <div class="mdl-card__title">
                <script>
                    function showimage() {
                        var storageRef = firebase.storage().ref();
                        var spaceRef = storageRef.child('sakura.jpg');
                        storageRef.child('sakura.jpg').getDownloadURL().then(function(url) {
                            var test = 'https://firebasestorage.googleapis.com/v0/b/study-chums.appspot.com/o/sakura.jpg?alt=media&token=903df6f5-d38a-41d8-b84a-ee2a4c470b16';
                            alert(url);
                            document.querySelector('img').src = test;
                        }).catch(function(error) {
                            
                        });
                    }
                </script>
                <style>
                    .demo-card-square > .mdl-card__title {
                        color: #fff;
                        background:
                        url(test) bottom right 15% no-repeat #46B6AC;
                    }
                </style>
            </div>
            <div class="mdl-card__title mdl-card--expand">
                <h2 class="mdl-card__title-text">Name(read Stroage)</h2>
            </div>
            <div class="mdl-card__supporting-text">
                short introduction about yourself, need get the message from cloud
            </div>
            <div class="mdl-card__actions mdl-card--border">
                <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                    Next
                </a>
            </div>
        </div>
      </div>

      <!-- END CONTENT-->

      <!-- FOOTER -->
      <footer>
        Designed and Developed by Team Motivation 2019
      </footer>
      <!-- END FOOTER -->

    </div>
  </body>
</html>