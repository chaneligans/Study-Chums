<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Discover | Study Chums</title>
    <link rel="icon" href="images/favicon.ico">
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>
    <!-- CHECK IF USED IS LOGGED IN -->
    <script type="text/javascript" src="scripts/check_login.js"></script>
    <script>
      $(document).ready(function(){
        $('.navbar-toggle').click(function() {
          $('#nav').toggle('.unhide');
        });
      });
      $(document).ready(function() {
          $('.main-btn').click(function() {
              $('.search-description').slideToggle(100);
          });
          $('.search-description li').click(function() {
              var target = $(this).html();
              var toRemove = 'By ';
              var newTarget = target.replace(toRemove, '');
              //remove spaces
              newTarget = newTarget.replace(/\s/g, '');
              $(".search-large").html(newTarget);
              $('.search-description').hide();
              $('.main-input').hide();
              newTarget = newTarget.toLowerCase();
              $('.main-' + newTarget).show();
          });
          $('#main-submit-mobile').click(function() {
            $('#main-submit').trigger('click');
          });
          $(window).resize(function() {
            replaceMatches();
          });
      
          function replaceMatches() {
            var width = $(window).width();
            if (width < 516) {
              $('.main-location').attr('value', 'Major');
            } else {
              $('.main-location').attr('value', 'Major');
            }
      
          }
      
          replaceMatches();
      
          function clearText(thefield) {
            if (thefield.defaultValue === thefield.value) {
              thefield.value = ""
            }
          }
      
          function replaceText(thefield) {
            if (thefield.value === "") {
              thefield.value = thefield.defaultValue
            }
          }
      });
      
      window.onload = checkLogin;
    </script>
    
    <!-- FACEBOOK SIGN OUT-->
    <script type="text/javascript" src="scripts/facebook_logout.js"></script>
    <!-- END FACEBOOK SIGN OUT -->
      
    <script>
        function Search() {
        $('html').addClass('waiting');
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            let name_in = document.getElementsByClassName("main-input main-name").value;
            let major_in = document.getElementsByClassName("main-input main-location").value;

            // execute only if something is there     
            if (name_in !== "") {SearchName(name_in);}
            
            if (major_in !== "") {SearchMajor(major_in);}

            console.log("Search sent to database.");
          } else {
            console.log("Who are you? And why do you have access to this?");
          }                              
        });
      }
        function SearchName(name_in){
            
        }
        function SearchMajor(major_in){
            
        }
    </script>
  </head>
  <body>
    <div id="wrapper">
      <!-- NAVIGATION MENU -->
      <nav class="navbar">
        <span class="navbar-toggle" id="js-navbar-toggle">
        &#x2630;
        </span>
        <ul id="nav" class="main-nav">
          <li><a href="home.html" class="nav-item">Home</a></li>
          <li><a href="discover.html" class="nav-item">Discover</a></li>
          <li><a href="profile.html" class="nav-item">Profile</a></li>
          <li><a href="messages.html" class="nav-item">Messages</a></li>
          <li><a href="chums.html" class="nav-item">Chums</a></li>
          <li><a href="applications.html" class="nav-item">Applications</a></li>
          <li><a class="nav-item" onclick="facebookSignOut()">Sign Out</a></li>
        </ul>
      </nav>
      <div id="content">
        <div id="description">
          <h1>Search for Chums</h1>
        </div>
        <div id="search">
          <div class="main-form-container">
            <form id="" class="" method="post">
              <input type="text" class="main-input main-name" name="NAME" onfocus="clearText(this)" onblur="replaceText(this)" /><input type="text" class="main-input main-location" name="LOCATION"  onfocus="clearText(this)" onblur="replaceText(this)" />
              <button type="button" class="main-btn">
                <p class="search-small">SEARCH BY</p>
                <p class="search-large">Name</p>
              </button>
              <ul class="search-description">
                <li>
                  By Major
                </li>
                <li>
                  By Name
                </li>
              </ul>
              <input id="main-submit" class="" type="submit" value="Search" onclick="Search();"/>
            </form>
          </div>
          <!-- mobile submit -->
          <button type="button" id="main-submit-mobile">Search</button>
        </div>
        <div id= "profileview">
        </div>
      </div>
    </div>
  </body>
</html>