<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset=utf-8>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="manifest" href="/manifest.json">

    <title>Messages | Study Chums</title>
    <link rel="icon" href="images/favicon.ico">
    <link rel="stylesheet" href="main.css">

    <!-- IMPORT ICONS -->
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <!-- IMPORT jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- IMPORT moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.js"></script>

    <!-- CHECK IF USED IS LOGGED IN -->
    <script type="text/javascript" src="scripts/check_login.js"></script>
    <!-- <script>window.onload = checkLogin;</script> -->

    <!-- FACEBOOK SIGN OUT-->
    <script type="text/javascript" src="scripts/site_logout.js"></script>

    <script type="text/javascript" src="scripts/dark-mode.js"></script>

    <!-- firebase IMPORT -->
    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>
    <script type="text/javascript" src="scripts/firebase-config.js"></script>
    <script>firebase.initializeApp(config);</script><!--Initialize Firebase-->

    <script type="text/javascript" src="scripts/chums.js"></script>
    <script type="text/javascript" src="scripts/messages.js"></script>

  </head>
  <body>
    <script>
      // Get a reference to the storage service, which is used to create references in your storage bucket
      var storage = firebase.storage();
      // Create a storage reference from our storage service
      var storageRef = storage.ref();
    </script>

    <div class="onoffswitch">
      <input type="checkbox" class="onoffswitch-checkbox" id="dark-switch">
      <label class="onoffswitch-label" for="dark-switch">
          <span class="onoffswitch-inner"></span>
          <span class="onoffswitch-switch"></span>
      </label>
    </div>

    <!-- WRAPPER (WHITE BOX) -->
    <div id="wrapper">
      <!-- NAVIGATION MENU -->
      <nav>
        <button id="menubutton" class="accordion">Menu</button>
        <ul class="panel">
          <li><a href="home.html" class="nav-item">Home</a></li>
          <li><a href="discover.html" class="nav-item">Discover</a></li>
          <li><a href="profile.html" class="nav-item">Profile</a></li>
          <li><a href="messages.html" class="nav-item">Messages</a></li>
          <li><a href="chums.html" class="nav-item">Chums</a></li>
          <li><a href="applications.html" class="nav-item">Applications</a></li>
          <li><a class="nav-item" onclick="siteSignOut();">Sign Out</a></li>
          <li><a href="preferences.html" class="nav-item"><i class="fas fa-user-cog"></i></a></li>
        </ul>
      </nav>
      <!-- END OF NAVIGATION MENU -->

      <!-- CONTENT (description, profiles) -->
      <div id="content">
        <div id="description">
          <h1>Messages</h1>
        </div>

        <div id="chatContainer">
          <aside id="leftSide">
            <!-- The popup box -->
            <div id="createChatPopup" class="chatPopup">
              <!-- Popup box content -->
              <div class="chatPopupContent">
                <span id="closeCreateChatPopup" class="closeChatPopup">&times;</span>
                <p id="createChatPopupTitle">New Chat Room</p>
                <input id="chatTopicIn" type="text" class="popupInput" placeholder="Topic">
                <h2>Chums</h2>
                <div id="popupCreateChatResults">
                  <script>retrievePopupBoxChums('popupCreateChatResults');</script>
                </div>
                <button id="createNewChatButton" onclick="createChatRoom()">Create New Chat</button>
              </div>
            </div>

            <header>
              <!-- after click on the plus button, pump up the list of chums, auto-create a room id by createROOMID
                    function with the topic input when selecting the user to call addUser functions -->
              <button id="openCreateChatPopup" onclick = "showCreateChatPopup();"><i class="fab fa-weixin"></i></button>
            </header>

            <script>reloadChatRoomSideBar();</script>
            <ul id = "leftSideRooms"> <!-- SIDE USER LIST -->
            </ul>
          </aside>
          <main id="rightSide">
            <script>setDarkFn(refresh_h); displayHeader();</script>

            <header id="chatHeader"> <!-- MAIN CHAT HEADER -->
            </header>
            <!-- Add Users to Existing Chat Popup -->
            <div id="addFriendToChatPopup">
                <div class="chatPopupContent">
                  <span id="closeAddFriendToChatPopup" class="closeChatPopup">&times;</span>
                  <h1 id="addFriendToChatPopupTitle">Add More Chums to Chat</h1>
                  <div id="popupAddFriendToChatResults">
                    <script>retrievePopupBoxChums('popupAddFriendToChatResults');</script>
                  </div>
                  <button class="modalButton" onclick="addMultipleUsersToChatRoom();">Add Chums</button>
                </div>
            </div>

            <div id="showEditIconPopup">
              <div class="showEditIconPopupContent">
                <span id="closeShowEditIconPopup" class="closeChatPopup">&times;</span>
                <h1 id="addFriendToChatPopupTitle">Edit the group icon</h1>
                <input id="newIconInput" type="file" accept="image/*">
                <p>Upload progress: <span id="editIconProgress">--</span>%</p>
                <br>
                <button class="modalButton" onclick="editGroupIcon();">Save</button>
              </div>
            </div>

            <script>loadChatHistory();</script>
            <ul id="chat"> <!-- CHAT -->
            </ul>
            <footer>
              <textarea id="message" placeholder="Type your message"></textarea>
              <button href="#" onclick="sendMessage();"><i class="fas fa-paper-plane"></i></button>
            </footer>
          </main>
        </div>
      </div> <!-- content div -->
      <!-- END CONTENT-->

      <!-- FOOTER -->
      <footer>
        Designed and Developed by Team Motivation 2019<br>
        <a href="privacypolicy.html">Privacy Policy</a>
      </footer>
      <!-- END FOOTER -->
    </div>

    <script type="text/javascript" src="scripts/toggle_bio.js"></script>
  </body>
</html>